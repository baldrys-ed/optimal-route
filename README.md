# optimal-route

Инструмент оценки комфорта и безопасности пешеходных маршрутов на основе данных [2GIS Routing API](https://docs.2gis.com/ru/api/navigation/routing).

Демо: **https://baldrys.duckdns.org**

---

## Как работает оценка маршрута

Каждый маршрут получает оценку от **0 до 10**. Она складывается из трёх вопросов.

---

### 1. По чему ты идёшь? (55% итога)

Каждый метр пути оценивается по типу покрытия:

| Тип           | Комфорт |
|---------------|---------|
| Парк, бульвар | 1.0     |
| Жилая зона    | 0.9     |
| Подземный переход | 0.85 |
| Тротуар       | 0.5     |
| Лестница      | 0.1     |

Считается средневзвешенное по длине — чем больше парков и бульваров, тем выше оценка.

---

### 2. Сколько раз переходишь дорогу? (30% итога)

Два штрафа одновременно:

- **Качество перехода** — светофор лучше зебры, зебра лучше, чем ничего
- **Количество переходов** — каждый новый переход снижает оценку, даже если он безопасный

Маршрут без единого пересечения проезжей части получает максимум (1.0). Маршрут с 8 зёбрами — примерно 0.34.

---

### 3. Насколько маршрут прямой? (15% итога)

Чем меньше поворотов и чем они плавнее — тем лучше. Прямой маршрут от точки А до точки Б без изгибов получает 1.0.

---

### Пример расчёта

Маршрут 1.9 км, 21 мин, 8 переходов (7 зебр + 1 светофор):

| Компонент | Расчёт | Значение | Вес | Вклад |
|-----------|--------|----------|-----|-------|
| Покрытие | 90% тротуар + 10% парк | 0.548 | ×0.55 | 0.301 |
| Переходы | avg 0.650 × штраф за 8 шт | 0.343 | ×0.30 | 0.103 |
| Прямолинейность | средний угол 38° | 0.789 | ×0.15 | 0.118 |
| **Итог** | | | **×10** | **5.2** |

---

### Шкала оценок

| Оценка | Что это значит |
|--------|----------------|
| 8–10 | Маршрут в основном по паркам и бульварам, мало переходов |
| 6–7 | Обычный городской маршрут по тротуарам |
| 5–6 | Много тротуара или несколько переходов дороги |
| ниже 5 | Много пересечений проезжей части или лестниц |

---

## Технический стек

- **Backend:** PHP 8.4, Symfony 8.0
- **Карты:** 2GIS MapGL JS
- **Данные маршрутов:** 2GIS Routing API v7

Подробная техническая документация формулы — в [FORMULA.md](FORMULA.md).
